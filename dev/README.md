# FocusPro

Система мониторинга и диагностики для терминалов и банкоматов.

## Статус

Рабочий макет.

## Основное

- Работает на "Raspberry Pi 3В+" с ОС "Raspbian".
- Интерфейс управления устройствами GPIO основан на библиотеке gpiozero.
- Работу с датчиками на шине 1-Wire обеспечивают дистрибутивы owfs и python-ow.
- Веб-интерфейс основан на фреймворке flask.

## Структура проекта

```
/conf -- конфигурация nginx
+--focus.conf -- настройка маршрутизации приложения на сервере
+--nginx.conf -- конфигурация основных параметров сервера
/focus -- корневой пакет приложения
+--/back -- бэкэнд
|  +--/hardware.py -- конфигурирование железа
|  |  +--__init__.py -- класс Hardware, инкапсулирующий детали конфигурирования железа
|  |  +--BaseUnit.py -- класс BaseUnit, от которого наследуется большинство остальных классов
|  |  +--FocusLED.py -- класс FocusLED, реализующий модель светового индикатора
|  |  +--FocusReceptor.py -- класс FocusReceptor, реализующий модель концевого датчика
|  |  +--FocusSocket.py -- класс FocusSocket, реализующий модель выходного гнезда
|  |  +--FocusSocketControl.py -- класс FocusSocketControl, реализующий модель контроля работоспособности гнезда
|  |  +--FocusTemperature.py -- класс FocusTemperature, реализующий модель температурного сенсора
|  |  +--FocusVoltage.py -- класс FocusVoltage, реализующий модель контроля за напряжением в устройстве
|  +--/reporting -- составление и отправка отчётов
|  |  +--__init__.py -- класс Reporter, инкапсулирующий детали составления отчётов
|  |  +--Content.py -- класс Content, ответственный за структурирование информации, содержащейся в отчёте
|  |  +--Message.py -- класс Message, реализующий модель сообщения для рапортирования
|  +--/utils -- вспомогательные утилиты для скриптов
|  |  +--__init__.py -- набор различных констант
|  |  +--concurrency.py -- инструменты для сопоточного исполнения команд
|  |  +--db_handlers.py -- инструменты для взаимодействия с локальной БД
|  |  +--messaging_tools.py -- инструменты для создания и обработки сообщений
|  |  +--one_wire.py -- инструменты для работы с компонентами 1-Wire
|  +--__init__.py -- класс Connector, реализующий модель MQTT-соединения для обмена данными с посредником
|  +--logger.py -- класс Logger, отвечающий за создание записей для всех событий на устройстве
+--/front -- фронтэнд
|  +--/static -- статические файлы
|  |  +--/css -- стили для страниц
|  +--/templates -- HTML-шаблоны
|  |  +--base.html -- базовый слой разметки для каждой страницы
|  |  +--index.html -- главная страница
|  |  +--log.html -- страница журнала событий
|  |  +--management.html -- страница управления компонентами устройства
|  +--__init__.py -- точка входа в приложение
|  +--models.py -- модели и функции для работы с БД
|  +--views.py -- представления моделей по определённым маршрутам
+--__init.py__ -- пустой модуль для распознавания пакета и сопоставления путей к вложенным модулям
+--config.yaml -- конфигурация оборудования
+--focus.log -- журнал событий
/systemd -- настройка служб автозапуска приложения
+--focus.service -- автозапуск gunicorn, установка сопутствующих параметров и привязка к Unix-сокету
+--focus.socket -- Unix-сокет для связывания gunicorn с прокси-сервером
.gitignore -- список игнорируемых файлов для системы контроля версий
README.md -- описание проекта
requirements.txt -- необходимые python-пакеты для исправного функционирования приложения
setup.py -- файл установки пакета focus для разрешения конфликтов поиска имён
```
